<!DOCTYPE html>
<html>
<head>
  <meta http-equiv='Content-type' content='text/html; charset=utf-8'>
  <title>KeepNote Notebook</title>

  <link type="text/css" rel="stylesheet" href="/static/thirdparty/bootstrap/css/bootstrap.css">
  <!--
  <link type="text/css" rel="stylesheet" href="/static/thirdparty/bootstrap/css/bootstrap-theme.css">
-->

  <link type="text/css" rel="stylesheet" href="/static/css/keepnote.css">

  <script type="text/javascript" src="/static/thirdparty/jquery/js/jquery.min.js"></script>
  <script type="text/javascript" src="/static/thirdparty/underscore/js/underscore.js"></script>
  <script type="text/javascript" src="/static/thirdparty/backbone/js/backbone.js"></script>
  <script type="text/javascript" src="/static/thirdparty/bootstrap/js/bootstrap.min.js"></script>
  <script type="text/javascript" src="/static/thirdparty/react/js/react.js"></script>
  <script type="text/javascript" src="/static/thirdparty/react/js/JSXTransformer.js"></script>

  <script type="text/javascript" src="/static/js/notebook.js"></script>
  <script type="text/jsx" src="/static/js/keepnote.jsx"></script>
</head>
<body>

<div id="base">
</div>


<script type="text/jsx">
    var notebook;

    function updateApp() {
        if (!notebook)
           return;
        React.render(
            <KeepNoteView notebook={notebook} />,
            $('#base').get(0)
        );
    }
    queueUpdateApp = _.debounce(updateApp, 0);

    function updateView() {
        // Render GUI.
        React.render(
            <NotebookTree node={notebook.root} />,
            $('#treeview-pane #notebook').get(0)
        );
    }
    queueUpdateView = _.debounce(updateView, 0);

    function onNoteBookChange() {
        queueUpdateApp();
    }

    $(document).ready(function () {
        updateApp();

        $(window).resize(queueUpdateApp);

        $.get('/notebook/').done(function (rootid) {
            notebook = new NoteBook({rootid: rootid});
            notebook.on("change", onNoteBookChange);
            notebook.fetch();
        });
    });
</script>

</body>
</html>
